# --- LEDs on HE0 (Manta M8P v0) ---
[output_pin daylight]
pin: PA3                  # if alias not found, replace with the MCU pin for HE0 (e.g. PA8/PBx per M8P sample cfg)
pwm: True
value: 0.0                # off at boot
shutdown_value: 0.0
cycle_time: 0.01          # 100 Hz; raise to 0.004 (250 Hz) if you see flicker
hardware_pwm: True        # set False if your MCU doesn’t support it

# Convenience macros
[gcode_macro DAYLIGHT_ON]
gcode:
  SET_PIN PIN=daylight VALUE=1.0

[gcode_macro DAYLIGHT_OFF]
gcode:
  SET_PIN PIN=daylight VALUE=0.0

[gcode_macro DAYLIGHT_S]
description: Set Daylight brightness 0–255
gcode:
  {% set s = params.S|default(255)|int %}
  {% if s < 0 %}
    {% set s = 0 %}
  {% elif s > 255 %}
    {% set s = 255 %}
  {% endif %}
  {% set val = s / 255.0 %}
  SET_PIN PIN=daylight VALUE={val}



  # --- Addressable LEDs: Disco on a Stick, chained ---
# Set these
#   MCU_PIN: the M8P pin that drives your 5V RGB header (e.g. PB0). Use the exact pin from the M8P sample cfg.
#   LEDS_PER_STICK: number of LEDs per Disco stick (e.g. 60)

[neopixel disco_chain]
pin: PD15
chain_count: 36     # both sticks
color_order: GRB                    # common; change to RGB/RGBW if needed
initial_RED: 0
initial_GREEN: 0
initial_BLUE: 0
# If RGBW LEDs, add e.g. initial_WHITE: 0 and use color_order: GRBW

# [led_effect bed_effects]
# leds:
#     neopixel:disco_chain
# autostart:                          true
# frame_rate:                         24
# heater:                             heater_bed
# layers:
#     heater  50 0 add    (1,1,0),(1,0,0)
#     static  0  0 top    (1,0,0)


[led_effect critical_error]
leds:
    neopixel:disco_chain
layers:
    strobe         1  1.5   add        (1.0,  1.0, 1.0)
    breathing      2  0     difference (0.95, 0.0, 0.0)
    static         1  0     top        (1.0,  0.0, 0.0)
autostart:                             false
frame_rate:                            24
run_on_error:                          true


[led_effect disco_full_white]
autostart: false
frame_rate: 10
leds:
  disco_chain
layers:
  static 1.0 (1.0,1.0,1.0)
