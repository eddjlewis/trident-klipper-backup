# --- LEDs on HE0 (Manta M8P v0) ---
[output_pin daylight]
pin: PA3                  # if alias not found, replace with the MCU pin for HE0 (e.g. PA8/PBx per M8P sample cfg)
pwm: True
value: 0.0                # off at boot
shutdown_value: 0.0
cycle_time: 0.01          # 100 Hz; raise to 0.004 (250 Hz) if you see flicker
hardware_pwm: True        # set False if your MCU doesn’t support it

# Convenience macros
[gcode_macro DAYLIGHT_ON]
gcode:
  SET_PIN PIN=daylight VALUE=1.0

[gcode_macro DAYLIGHT_OFF]
gcode:
  SET_PIN PIN=daylight VALUE=0.0

[gcode_macro DAYLIGHT_S]
description: Set Daylight brightness 0–255
gcode:
  {% set s = params.S|default(255)|int %}
  {% if s < 0 %}
    {% set s = 0 %}
  {% elif s > 255 %}
    {% set s = 255 %}
  {% endif %}
  {% set val = s / 255.0 %}
  SET_PIN PIN=daylight VALUE={val}



  # --- Addressable LEDs: Disco on a Stick, chained ---
# Set these
#   MCU_PIN: the M8P pin that drives your 5V RGB header (e.g. PB0). Use the exact pin from the M8P sample cfg.
#   LEDS_PER_STICK: number of LEDs per Disco stick (e.g. 60)

[neopixel disco_chain]
pin: PD15
chain_count: 36     # both sticks
color_order: GRB                    # common; change to RGB/RGBW if needed
initial_RED: 0
initial_GREEN: 0
initial_BLUE: 0
# If RGBW LEDs, add e.g. initial_WHITE: 0 and use color_order: GRBW

[gcode_macro DISCO_OFF]
gcode:
  SET_LED LED=disco_chain RED=0 GREEN=0 BLUE=0 TRANSMIT=1

[gcode_macro DISCO_WHITE]
description: White brightness S=0..255
gcode:
  {% set s = params.S|default(255)|int %}
  {% if s<0 %}{% set s=0 %}{% elif s>255 %}{% set s=255 %}{% endif %}
  {% set v = s/255.0 %}
  SET_LED LED=disco_chain RED={v} GREEN={v} BLUE={v} TRANSMIT=1

[gcode_macro DISCO_RGB]
description: Set RGB 0..255, e.g. DISCO_RGB R=255 G=64 B=0
gcode:
  {% set r = params.R|default(255)|int %}
  {% set g = params.G|default(255)|int %}
  {% set b = params.B|default(255)|int %}
  {% if r<0 %}{% set r=0 %}{% elif r>255 %}{% set r=255 %}{% endif %}
  {% if g<0 %}{% set g=0 %}{% elif g>255 %}{% set g=255 %}{% endif %}
  {% if b<0 %}{% set b=0 %}{% elif b>255 %}{% set b=255 %}{% endif %}
  {% set rf=r/255.0 %}{% set gf=g/255.0 %}{% set bf=b/255.0 %}
  SET_LED LED=disco_chain RED={rf} GREEN={gf} BLUE={bf} TRANSMIT=1
